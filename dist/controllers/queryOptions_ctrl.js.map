{"version":3,"sources":["../../src/controllers/queryOptions_ctrl.js"],"names":["_","DefaultFlags","MeasurementStateFlags","PhasorQueryOptionsCtrl","$scope","$compile","dataFlags","flags","undefined","merge","return","Included","Excluded","IncludeNormal","flagArray","map","Object","keys","key","a","order","Order","sort","b","calculateInitialFlags","flag","type","ctrl","flagVarIncluded","flagVarExcluded","each","index","list","padDigits","dec2hex","Normal","number","toString","toUpperCase","digits","Array","Math","max","String","length","join"],"mappings":"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","file":"queryOptions_ctrl.js","sourcesContent":["//******************************************************************************************************\r\n//  queryOptions_ctrl.js - Gbtc\r\n//\r\n//  Copyright ï¿½ 2017, Grid Protection Alliance.  All Rights Reserved.\r\n//\r\n//  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See\r\n//  the NOTICE file distributed with this work for additional information regarding copyright ownership.\r\n//  The GPA licenses this file to you under the MIT License (MIT), the \"License\"; you may not use this\r\n//  file except in compliance with the License. You may obtain a copy of the License at:\r\n//\r\n//      http://opensource.org/licenses/MIT\r\n//\r\n//  Unless agreed to in writing, the subject software distributed under the License is distributed on an\r\n//  \"AS-IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the\r\n//  License for the specific language governing permissions and limitations.\r\n//\r\n//  Code Modification History:\r\n//  ----------------------------------------------------------------------------------------------------\r\n//  10/31/2017 - Billy Ernest\r\n//       Generated original version of source code.\r\n//\r\n//******************************************************************************************************\r\nimport _ from \"lodash\";\r\nimport { DefaultFlags, MeasurementStateFlags } from './../js/constants.js'\r\n\r\nexport class PhasorQueryOptionsCtrl {\r\n    constructor($scope, $compile) {\r\n        // #region Members\r\n\r\n        this.$scope = $scope;\r\n        this.dataFlags = ($scope.flags == undefined ? DefaultFlags : _.merge(DefaultFlags, $scope.flags));\r\n        this.return = $scope.return;\r\n\r\n        this.return.Included = (this.return.Included == undefined ? 0xFFFFFFF : this.return.Included);\r\n        this.return.Excluded = (this.return.Excluded == undefined ? 0x0000000 : this.return.Excluded);\r\n        this.return.IncludeNormal = (this.return.IncludeNormal == undefined ? true : this.return.IncludeNormal);\r\n\r\n        this.flagArray = _.map(Object.keys(this.dataFlags), a => {\r\n            return { key: a, order: this.dataFlags[a].Order };\r\n        }).sort((a, b) => {\r\n            return a.order - b.order;\r\n        });\r\n\r\n        this.calculateInitialFlags();\r\n        // #endregion\r\n    }\r\n\r\n    // #region Methods\r\n    calculateFlags(flag, type) {\r\n        var ctrl = this;\r\n\r\n        var flagVarIncluded = 0;\r\n        var flagVarExcluded = 0;\r\n\r\n        if (flag == 'Select All') {\r\n            _.each(Object.keys(ctrl.dataFlags), function (key, index, list) {\r\n                if (type == 'Included') {\r\n                    ctrl.dataFlags[key].Excluded = false;\r\n                    ctrl.dataFlags[key].Included = true;\r\n                }\r\n                else if (type == 'Excluded') {\r\n                    ctrl.dataFlags[key].Included = false;\r\n                    ctrl.dataFlags[key].Excluded = true;\r\n                }\r\n            });\r\n\r\n            if (type == 'Included') {\r\n                flagVarIncluded = 0xFFFFFFFF;\r\n                flagVarExcluded = 0x00000000;\r\n            }\r\n            else if (type == 'Excluded') {\r\n                flagVarExcluded = 0xFFFFFFFF;\r\n                flagVarIncluded = 0x00000000;\r\n            }\r\n\r\n        }\r\n        else {\r\n            ctrl.dataFlags['Select All'].Included = false;\r\n            ctrl.dataFlags['Select All'].Excluded = false;\r\n\r\n            _.each(Object.keys(ctrl.dataFlags), function (key, index, list) {\r\n                if (key == 'Select All') return;\r\n\r\n                if (type == 'Included') {\r\n                    ctrl.dataFlags[key].Excluded = !ctrl.dataFlags[key].Included\r\n                }\r\n                else if (type == 'Excluded') {\r\n                    ctrl.dataFlags[key].Included = !ctrl.dataFlags[key].Excluded\r\n                }\r\n\r\n\r\n                flagVarIncluded = flagVarIncluded | (ctrl.dataFlags[key].Included ? MeasurementStateFlags[key] : 0);\r\n                flagVarExcluded = flagVarExcluded | (ctrl.dataFlags[key].Excluded ? MeasurementStateFlags[key] : 0);\r\n            });\r\n        }\r\n\r\n        ctrl.return.Included = '0x' + ctrl.padDigits(this.dec2hex(flagVarIncluded), 8);\r\n        ctrl.return.Excluded = '0x' + ctrl.padDigits(this.dec2hex(flagVarExcluded), 8);\r\n        ctrl.return.IncludeNormal = ctrl.dataFlags.Normal.Included\r\n        ctrl.$scope.flags = ctrl.dataFlags;\r\n    }\r\n\r\n    calculateInitialFlags() {\r\n        var ctrl = this;\r\n        var flagVarIncluded = 0;\r\n        var flagVarExcluded = 0;\r\n\r\n        _.each(Object.keys(ctrl.dataFlags), function (key, index, list) {\r\n            if (key == 'Select All') return;\r\n\r\n            flagVarIncluded = flagVarIncluded | (ctrl.dataFlags[key].Included ? MeasurementStateFlags[key] : 0);\r\n            flagVarExcluded = flagVarExcluded | (ctrl.dataFlags[key].Excluded ? MeasurementStateFlags[key] : 0);\r\n        });\r\n\r\n        ctrl.return.Included = '0x' + ctrl.padDigits(this.dec2hex(flagVarIncluded), 8);\r\n        ctrl.return.Excluded = '0x' + ctrl.padDigits(this.dec2hex(flagVarExcluded), 8);\r\n\r\n    }\r\n\r\n    dec2hex(number) {\r\n        if (number < 0) {\r\n            number = 0xFFFFFFFF + number + 1;\r\n        }\r\n\r\n        return number.toString(16).toUpperCase();\r\n    }\r\n\r\n    padDigits(number, digits) {\r\n        return Array(Math.max(digits - String(number).length + 1, 0)).join(0) + number;\r\n    }\r\n\r\n    // #endregion\r\n\r\n}\r\n"]}